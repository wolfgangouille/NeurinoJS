<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>My eNeuron Simulator</title>
  <script src="./bundle.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
  <script>   xdata=[];  simuldata=[];  myChart=null; colors=["red","green","blue","magenta","yellow","cyan","black"]</script>
</head>
<body>
  <!-- lots of HTML here -->



  <br>
  <button onclick="runGlobalNet()">Run simulation</button>
  <button onclick="addtoglobnet()">Add Neuron</button>
  <button onclick="addSynapse()">Add Synapse A->B</button>
  <br>
  <br>
  <form>
    <label for="listn1">Neuron A :</label>
    <label for="listn2">Neuron B :</label><br>
    <select id="listn1" name="listn1" onchange="displayNeuron()"></select>
    <select id="listn2" name="listn2"></select>
  </form>
  <br>

  <form>Neuron A Properties :<br>
    <label for="iext">Input Current:</label>
    <input type="text" id="iext" name="iext" value=""></input><br>
    <label for="vrest">Resting Potential:</label>
    <input type="text" id="vrest" name="vrest" value=""></input><br>
    <label for="vreset">Reset Potential:</label>
    <input type="text" id="vreset" name="vreset" value=""></input><br>
    <label for="vthresh">Threshold:</label>
    <input type="text" id="vthresh" name="vthresh" value=""></input><br>
    <label for="c">Capacitance:</label>
    <input type="text" id="c" name="c" value=""></input><br>
    <label for="r">Resistance:</label>
    <input type="text" id="r" name="r" value=""></input><br>
    <label for="synapses">Outgoing Synapses:</label>
    <select id="synapses" name="synapses" value=""></select><br>
  </form>

  <br>

  <button onclick="applyneurchanges()">Apply Changes</button>

  <br>

  <canvas id="myChart" style="width:100%;max-width:700px"></canvas>

  <form>
    <label for="res">Results:</label><br>
    <textarea id="res" name="res" rows="30" cols="50"></textarea><br>
  </form>


  <script>function doSomth(){
    console.log("blablabli")
  }
</script>
<script>
function displayNeuron(){
  document.getElementById('iext').value=globalnet.Neurons[document.getElementById('listn1').selectedIndex].Iext;
  document.getElementById('vrest').value=globalnet.Neurons[document.getElementById('listn1').selectedIndex].Vrest;
  document.getElementById('vreset').value=globalnet.Neurons[document.getElementById('listn1').selectedIndex].Vreset;
  document.getElementById('vthresh').value=globalnet.Neurons[document.getElementById('listn1').selectedIndex].Vthresh;
  document.getElementById('c').value=globalnet.Neurons[document.getElementById('listn1').selectedIndex].C;
  document.getElementById('r').value=globalnet.Neurons[document.getElementById('listn1').selectedIndex].R;
  document.getElementById('synapses').value=globalnet.Neurons[document.getElementById('listn1').selectedIndex].R;
  document.getElementById('synapses').length=0;
  for (let i=0;i<globalnet.Neurons[(document.getElementById('listn1').selectedIndex)].OutSyns.length;i++){
    var newOption1 = new Option("Synapse "+ i.toString(),globalnet.Neurons[(document.getElementById('listn1').selectedIndex)].OutSyns[i]);
    document.getElementById('synapses').add(newOption1,undefined);
  }

}
</script>

<script>
function applyneurchanges(){
  globalnet.Neurons[(document.getElementById('listn1').selectedIndex)].Iext=parseFloat(document.getElementById('iext').value);
  globalnet.Neurons[(document.getElementById('listn1').selectedIndex)].Vrest=parseFloat(document.getElementById('vrest').value);
  globalnet.Neurons[(document.getElementById('listn1').selectedIndex)].Vreset=parseFloat(document.getElementById('vreset').value);
  globalnet.Neurons[(document.getElementById('listn1').selectedIndex)].Vthresh=parseFloat(document.getElementById('vthresh').value);
  globalnet.Neurons[(document.getElementById('listn1').selectedIndex)].C=parseFloat(document.getElementById('c').value);
  globalnet.Neurons[(document.getElementById('listn1').selectedIndex)].R=parseFloat(document.getElementById('r').value);
}
</script>


<script>
//document.getElementById("canvas").getContext("2d")
var myChart=new Chart("myChart", {
  type: "line",
  data: {},
options: {
  //legend: {display: true},
  scaleFontColor: 'red',
  animation: {duration: 0},
  scales:{
    yAxes:[{
      Min: 50,
      Max: 100
    }],
  },
}
});

</script>

<script>

function drawGraph(){

  class datasetObject{
    constructor(){
      this.label="";
      this.fill=false;
      this.pointRadius=0,
      this.data=[];
      this.borderColor='red';
      this.cubicInterpolationMode='no';
    }
    /*label:"",
    fill: false,
    pointRadius: 0,
    data:[],
    borderColor: "red",
    cubicInterpolationMode:"no",*/
  };

  myChart.data.labels=xdata;
  myChart.data.datasets.length=0;
  for (let i=0;i<globalnet.Neurons.length;i++){
    myChart.data.datasets.push(new datasetObject);
    myChart.data.datasets[i].data=simuldata[i];
    myChart.data.datasets[i].label="Neuron "+i.toString();
    myChart.data.datasets[i].fill=false;
    myChart.data.datasets[i].pointRadius=0;
    myChart.data.datasets[i].borderColor= colors[i%7];
    myChart.data.datasets[i].cubicInterpolationMode="no";
  }
  myChart.options = {
  legend: {display: true},
  animation: {duration: 0},
  scales: {
    yAxes: [{
      display: true,
      ticks: {
        maxTicksLimit: 5,
        beginAtZero: false,
        min: -2,
        max: 2,
        stepSize: 0.5
       }
    }],
    xAxes: [{
      display: true,
      ticks: {
        userCallback: function(label, index, labels) {
                     // when the floored value is the same as the value we have a whole number

                         return (Math.round(label*100)/100);

                   },
        maxTicksLimit: 10,
      }
    }]
  }
}
  myChart.update();
  //var xValues = [0 1 2 3 4 5];

}
</script>

</body>
</html>
